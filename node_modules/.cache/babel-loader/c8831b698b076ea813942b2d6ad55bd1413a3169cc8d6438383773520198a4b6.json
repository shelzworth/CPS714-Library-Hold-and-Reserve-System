{"ast":null,"code":"// src/services/holdsService.js\n// Core holds and reservations management\n\nimport { db } from '../firebase-config';\nimport { collection, doc, getDocs, getDoc, addDoc, updateDoc, deleteDoc, query, where, orderBy, Timestamp } from 'firebase/firestore';\nimport { validateHoldRequest, validateReservationRequest, getUserProfile } from './remoteSyncService';\n\n// ============================================\n// HOLDS MANAGEMENT\n// ============================================\n\nexport async function placeHold(userId, itemId) {\n  try {\n    const validation = await validateHoldRequest(userId, itemId);\n    if (!validation.valid) {\n      return {\n        success: false,\n        error: validation.reason\n      };\n    }\n    const holdData = {\n      userId,\n      itemId,\n      status: 'waiting',\n      position: await getNextQueuePosition(itemId),\n      createdAt: Timestamp.now(),\n      notified: false\n    };\n    const holdRef = await addDoc(collection(db, 'holds'), holdData);\n    console.log('Hold placed:', holdRef.id);\n    return {\n      success: true,\n      holdId: holdRef.id,\n      ...holdData\n    };\n  } catch (error) {\n    console.error('Error placing hold:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\nexport async function placeReservation(userId, itemId) {\n  try {\n    const validation = await validateReservationRequest(userId, itemId);\n    if (!validation.valid) {\n      return {\n        success: false,\n        error: validation.reason\n      };\n    }\n    const reservationData = {\n      userId,\n      itemId,\n      status: 'active',\n      expiresAt: Timestamp.fromDate(new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)),\n      createdAt: Timestamp.now()\n    };\n    const resRef = await addDoc(collection(db, 'reservations'), reservationData);\n    console.log('Reservation placed:', resRef.id);\n    return {\n      success: true,\n      reservationId: resRef.id,\n      ...reservationData\n    };\n  } catch (error) {\n    console.error('Error placing reservation:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\nexport async function getUserHolds(userId) {\n  try {\n    const holdsCol = collection(db, 'holds');\n    const q = query(holdsCol, where('userId', '==', userId));\n    const snapshot = await getDocs(q);\n    const holds = snapshot.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n    const userProfile = await getUserProfile(userId);\n    return {\n      success: true,\n      holds,\n      userInfo: userProfile.success ? userProfile.data : null\n    };\n  } catch (error) {\n    console.error('Error fetching user holds:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\nexport async function getUserReservations(userId) {\n  try {\n    const resCol = collection(db, 'reservations');\n    const q = query(resCol, where('userId', '==', userId));\n    const snapshot = await getDocs(q);\n    const reservations = snapshot.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n    return {\n      success: true,\n      reservations\n    };\n  } catch (error) {\n    console.error('Error fetching user reservations:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\nexport async function getItemHolds(itemId) {\n  try {\n    const holdsCol = collection(db, 'holds');\n    const q = query(holdsCol, where('itemId', '==', itemId), orderBy('position', 'asc'));\n    const snapshot = await getDocs(q);\n    return snapshot.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n  } catch (error) {\n    console.error('Error fetching item holds:', error);\n    return [];\n  }\n}\nexport async function cancelHold(holdId) {\n  try {\n    const holdRef = doc(db, 'holds', holdId);\n    const holdSnap = await getDoc(holdRef);\n    if (!holdSnap.exists()) {\n      return {\n        success: false,\n        error: 'Hold not found'\n      };\n    }\n    const holdData = holdSnap.data();\n    await deleteDoc(holdRef);\n    await reorderHoldQueue(holdData.itemId);\n    console.log('Hold cancelled:', holdId);\n    return {\n      success: true\n    };\n  } catch (error) {\n    console.error('Error cancelling hold:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\nexport async function cancelReservation(reservationId) {\n  try {\n    const resRef = doc(db, 'reservations', reservationId);\n    await updateDoc(resRef, {\n      status: 'cancelled'\n    });\n    console.log('Reservation cancelled:', reservationId);\n    return {\n      success: true\n    };\n  } catch (error) {\n    console.error('Error cancelling reservation:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\nexport async function updateHoldStatus(holdId, status, notified = false) {\n  try {\n    const holdRef = doc(db, 'holds', holdId);\n    await updateDoc(holdRef, {\n      status,\n      notified\n    });\n    console.log('Hold status updated:', holdId, status);\n    return {\n      success: true\n    };\n  } catch (error) {\n    console.error('Error updating hold status:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\n\n// ============================================\n// HELPER FUNCTIONS\n// ============================================\n\nasync function getNextQueuePosition(itemId) {\n  const holds = await getItemHolds(itemId);\n  return holds.length + 1;\n}\nasync function reorderHoldQueue(itemId) {\n  const holds = await getItemHolds(itemId);\n  for (let i = 0; i < holds.length; i++) {\n    const holdRef = doc(db, 'holds', holds[i].id);\n    await updateDoc(holdRef, {\n      position: i + 1\n    });\n  }\n}\n\n// ============================================\n// ADMIN FUNCTIONS\n// ============================================\n\nexport async function getAllHolds() {\n  try {\n    const snapshot = await getDocs(collection(db, 'holds'));\n    return snapshot.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n  } catch (error) {\n    console.error('Error fetching all holds:', error);\n    return [];\n  }\n}\nexport async function getAllReservations() {\n  try {\n    const snapshot = await getDocs(collection(db, 'reservations'));\n    return snapshot.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n  } catch (error) {\n    console.error('Error fetching all reservations:', error);\n    return [];\n  }\n}\nexport async function expireOldReservations() {\n  try {\n    const resCol = collection(db, 'reservations');\n    const snapshot = await getDocs(resCol);\n    const now = Timestamp.now();\n    const expired = [];\n    for (const docSnap of snapshot.docs) {\n      const data = docSnap.data();\n      if (data.status === 'active' && data.expiresAt && data.expiresAt.toMillis() < now.toMillis()) {\n        await updateDoc(doc(db, 'reservations', docSnap.id), {\n          status: 'expired'\n        });\n        expired.push(docSnap.id);\n      }\n    }\n    console.log('Expired reservations:', expired.length);\n    return {\n      success: true,\n      expiredCount: expired.length\n    };\n  } catch (error) {\n    console.error('Error expiring reservations:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}","map":{"version":3,"names":["db","collection","doc","getDocs","getDoc","addDoc","updateDoc","deleteDoc","query","where","orderBy","Timestamp","validateHoldRequest","validateReservationRequest","getUserProfile","placeHold","userId","itemId","validation","valid","success","error","reason","holdData","status","position","getNextQueuePosition","createdAt","now","notified","holdRef","console","log","id","holdId","message","placeReservation","reservationData","expiresAt","fromDate","Date","resRef","reservationId","getUserHolds","holdsCol","q","snapshot","holds","docs","map","data","userProfile","userInfo","getUserReservations","resCol","reservations","getItemHolds","cancelHold","holdSnap","exists","reorderHoldQueue","cancelReservation","updateHoldStatus","length","i","getAllHolds","getAllReservations","expireOldReservations","expired","docSnap","toMillis","push","expiredCount"],"sources":["/Users/natnael/Documents/University/CPS 714/CPS714-Library-Hold-and-Reserve-System/src/services/holdsService.js"],"sourcesContent":["// src/services/holdsService.js\n// Core holds and reservations management\n\nimport { db } from '../firebase-config';\nimport { \n  collection, \n  doc, \n  getDocs, \n  getDoc,\n  addDoc, \n  updateDoc,\n  deleteDoc,\n  query, \n  where,\n  orderBy,\n  Timestamp \n} from 'firebase/firestore';\nimport { \n  validateHoldRequest, \n  validateReservationRequest,\n  getUserProfile \n} from './remoteSyncService';\n\n// ============================================\n// HOLDS MANAGEMENT\n// ============================================\n\nexport async function placeHold(userId, itemId) {\n  try {\n    const validation = await validateHoldRequest(userId, itemId);\n    if (!validation.valid) {\n      return { success: false, error: validation.reason };\n    }\n    \n    const holdData = {\n      userId,\n      itemId,\n      status: 'waiting',\n      position: await getNextQueuePosition(itemId),\n      createdAt: Timestamp.now(),\n      notified: false\n    };\n\n    const holdRef = await addDoc(collection(db, 'holds'), holdData);\n    \n    console.log('Hold placed:', holdRef.id);\n    return { success: true, holdId: holdRef.id, ...holdData };\n  } catch (error) {\n    console.error('Error placing hold:', error);\n    return { success: false, error: error.message };\n  }\n}\n\nexport async function placeReservation(userId, itemId) {\n  try {\n    const validation = await validateReservationRequest(userId, itemId);\n    if (!validation.valid) {\n      return { success: false, error: validation.reason };\n    }\n    \n    const reservationData = {\n      userId,\n      itemId,\n      status: 'active',\n      expiresAt: Timestamp.fromDate(new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)),\n      createdAt: Timestamp.now()\n    };\n\n    const resRef = await addDoc(collection(db, 'reservations'), reservationData);\n    \n    console.log('Reservation placed:', resRef.id);\n    return { success: true, reservationId: resRef.id, ...reservationData };\n  } catch (error) {\n    console.error('Error placing reservation:', error);\n    return { success: false, error: error.message };\n  }\n}\n\nexport async function getUserHolds(userId) {\n  try {\n    const holdsCol = collection(db, 'holds');\n    const q = query(holdsCol, where('userId', '==', userId));\n    const snapshot = await getDocs(q);\n    \n    const holds = snapshot.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n    \n    const userProfile = await getUserProfile(userId);\n    \n    return {\n      success: true,\n      holds,\n      userInfo: userProfile.success ? userProfile.data : null\n    };\n  } catch (error) {\n    console.error('Error fetching user holds:', error);\n    return { success: false, error: error.message };\n  }\n}\n\nexport async function getUserReservations(userId) {\n  try {\n    const resCol = collection(db, 'reservations');\n    const q = query(resCol, where('userId', '==', userId));\n    const snapshot = await getDocs(q);\n    \n    const reservations = snapshot.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n    \n    return { success: true, reservations };\n  } catch (error) {\n    console.error('Error fetching user reservations:', error);\n    return { success: false, error: error.message };\n  }\n}\n\nexport async function getItemHolds(itemId) {\n  try {\n    const holdsCol = collection(db, 'holds');\n    const q = query(\n      holdsCol, \n      where('itemId', '==', itemId),\n      orderBy('position', 'asc')\n    );\n    const snapshot = await getDocs(q);\n    \n    return snapshot.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n  } catch (error) {\n    console.error('Error fetching item holds:', error);\n    return [];\n  }\n}\n\nexport async function cancelHold(holdId) {\n  try {\n    const holdRef = doc(db, 'holds', holdId);\n    const holdSnap = await getDoc(holdRef);\n    \n    if (!holdSnap.exists()) {\n      return { success: false, error: 'Hold not found' };\n    }\n    \n    const holdData = holdSnap.data();\n    await deleteDoc(holdRef);\n    \n    await reorderHoldQueue(holdData.itemId);\n    \n    console.log('Hold cancelled:', holdId);\n    return { success: true };\n  } catch (error) {\n    console.error('Error cancelling hold:', error);\n    return { success: false, error: error.message };\n  }\n}\n\nexport async function cancelReservation(reservationId) {\n  try {\n    const resRef = doc(db, 'reservations', reservationId);\n    await updateDoc(resRef, { status: 'cancelled' });\n    \n    console.log('Reservation cancelled:', reservationId);\n    return { success: true };\n  } catch (error) {\n    console.error('Error cancelling reservation:', error);\n    return { success: false, error: error.message };\n  }\n}\n\nexport async function updateHoldStatus(holdId, status, notified = false) {\n  try {\n    const holdRef = doc(db, 'holds', holdId);\n    await updateDoc(holdRef, { status, notified });\n    \n    console.log('Hold status updated:', holdId, status);\n    return { success: true };\n  } catch (error) {\n    console.error('Error updating hold status:', error);\n    return { success: false, error: error.message };\n  }\n}\n\n// ============================================\n// HELPER FUNCTIONS\n// ============================================\n\nasync function getNextQueuePosition(itemId) {\n  const holds = await getItemHolds(itemId);\n  return holds.length + 1;\n}\n\nasync function reorderHoldQueue(itemId) {\n  const holds = await getItemHolds(itemId);\n  \n  for (let i = 0; i < holds.length; i++) {\n    const holdRef = doc(db, 'holds', holds[i].id);\n    await updateDoc(holdRef, { position: i + 1 });\n  }\n}\n\n// ============================================\n// ADMIN FUNCTIONS\n// ============================================\n\nexport async function getAllHolds() {\n  try {\n    const snapshot = await getDocs(collection(db, 'holds'));\n    return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n  } catch (error) {\n    console.error('Error fetching all holds:', error);\n    return [];\n  }\n}\n\nexport async function getAllReservations() {\n  try {\n    const snapshot = await getDocs(collection(db, 'reservations'));\n    return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n  } catch (error) {\n    console.error('Error fetching all reservations:', error);\n    return [];\n  }\n}\n\nexport async function expireOldReservations() {\n  try {\n    const resCol = collection(db, 'reservations');\n    const snapshot = await getDocs(resCol);\n    const now = Timestamp.now();\n    \n    const expired = [];\n    \n    for (const docSnap of snapshot.docs) {\n      const data = docSnap.data();\n      if (data.status === 'active' && data.expiresAt && data.expiresAt.toMillis() < now.toMillis()) {\n        await updateDoc(doc(db, 'reservations', docSnap.id), { status: 'expired' });\n        expired.push(docSnap.id);\n      }\n    }\n    \n    console.log('Expired reservations:', expired.length);\n    return { success: true, expiredCount: expired.length };\n  } catch (error) {\n    console.error('Error expiring reservations:', error);\n    return { success: false, error: error.message };\n  }\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}