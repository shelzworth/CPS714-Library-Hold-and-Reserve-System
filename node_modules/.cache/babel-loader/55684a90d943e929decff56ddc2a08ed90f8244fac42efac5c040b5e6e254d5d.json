{"ast":null,"code":"// src/services/remoteSyncService.js\n// Syncs data from Project 2 (catalog) and Project 4 (users) into your local Firebase\n\nimport { initializeApp } from 'firebase/app';\nimport { getFirestore, collection, doc, getDoc, getDocs, setDoc, query, where } from 'firebase/firestore';\nimport { db as localDb } from '../firebase-config';\n\n// ============================================\n// REMOTE FIREBASE CONFIGURATIONS\n// ============================================\n\n// Project 4 - User Dashboard Firebase\nconst project4Config = {\n  apiKey: \"AIzaSyA5Q_MVI7W1F58N9cKyDuSmFVsW3QlSTt8\",\n  authDomain: \"cps714-group-3-subproject-4.firebaseapp.com\",\n  databaseURL: \"https://cps714-group-3-subproject-4-default-rtdb.firebaseio.com\",\n  projectId: \"cps714-group-3-subproject-4\",\n  storageBucket: \"cps714-group-3-subproject-4.firebasestorage.app\",\n  messagingSenderId: \"989632490584\",\n  appId: \"1:989632490584:web:4f79336c85fd314d272e2d\"\n};\n\n// Project 2 - Catalog System Firebase\n// TODO: Get this from Project 2 team\nconst project2Config = {\n  apiKey: \"YOUR_PROJECT2_API_KEY\",\n  authDomain: \"your-project2.firebaseapp.com\",\n  projectId: \"your-project2\",\n  storageBucket: \"your-project2.firebasestorage.app\",\n  messagingSenderId: \"YOUR_MESSAGING_ID\",\n  appId: \"YOUR_APP_ID\"\n};\n\n// Initialize remote Firebase apps\nconst project4App = initializeApp(project4Config, 'project4');\nconst project4Db = getFirestore(project4App);\n\n// Uncomment when you get Project 2 credentials\n// const project2App = initializeApp(project2Config, 'project2');\n// const project2Db = getFirestore(project2App);\n\n// Temporary: Use mock data until Project 2 is ready\nconst project2Db = null;\n\n// ============================================\n// USER DATA SYNC (from Project 4)\n// ============================================\n\nexport async function syncUserProfile(userId) {\n  try {\n    const userRef = doc(project4Db, 'users', userId);\n    const userSnap = await getDoc(userRef);\n    if (!userSnap.exists()) {\n      console.error('User not found in Project 4');\n      return {\n        success: false,\n        error: 'User not found'\n      };\n    }\n    const userData = userSnap.data();\n    await setDoc(doc(localDb, 'cached_users', userId), {\n      ...userData,\n      lastSynced: new Date(),\n      source: 'project4'\n    });\n    console.log('User profile synced:', userId);\n    return {\n      success: true,\n      data: userData\n    };\n  } catch (error) {\n    console.error('Error syncing user profile:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\nexport async function getUserProfile(userId) {\n  try {\n    const cachedRef = doc(localDb, 'cached_users', userId);\n    const cachedSnap = await getDoc(cachedRef);\n    if (cachedSnap.exists()) {\n      const cached = cachedSnap.data();\n      const hoursSinceSync = (new Date() - cached.lastSynced.toDate()) / (1000 * 60 * 60);\n      if (hoursSinceSync < 1) {\n        return {\n          success: true,\n          data: cached,\n          fromCache: true\n        };\n      }\n    }\n    return await syncUserProfile(userId);\n  } catch (error) {\n    console.error('Error getting user profile:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\nexport async function syncUserLoans(userId) {\n  try {\n    const loansQuery = query(collection(project4Db, 'loans'), where('userId', '==', userId));\n    const loansSnap = await getDocs(loansQuery);\n    const loans = loansSnap.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n    await setDoc(doc(localDb, 'cached_loans', userId), {\n      loans,\n      lastSynced: new Date(),\n      source: 'project4'\n    });\n    console.log('User loans synced:', userId, loans.length);\n    return {\n      success: true,\n      data: loans\n    };\n  } catch (error) {\n    console.error('Error syncing user loans:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\n\n// ============================================\n// CATALOG DATA SYNC (from Project 2)\n// ============================================\n\nexport async function syncCatalogItem(itemId) {\n  try {\n    // TODO: Enable when Project 2 credentials are available\n    if (!project2Db) {\n      console.warn('Project 2 not configured, using mock data');\n      return {\n        success: false,\n        error: 'Project 2 catalog not configured yet'\n      };\n    }\n    const itemRef = doc(project2Db, 'catalog_items', itemId);\n    const itemSnap = await getDoc(itemRef);\n    if (!itemSnap.exists()) {\n      console.error('Item not found in Project 2 catalog');\n      return {\n        success: false,\n        error: 'Item not found'\n      };\n    }\n    const itemData = itemSnap.data();\n    await setDoc(doc(localDb, 'cached_catalog', itemId), {\n      ...itemData,\n      lastSynced: new Date(),\n      source: 'project2'\n    });\n    console.log('Catalog item synced:', itemId);\n    return {\n      success: true,\n      data: itemData\n    };\n  } catch (error) {\n    console.error('Error syncing catalog item:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\nexport async function checkItemAvailability(itemId) {\n  try {\n    const cachedRef = doc(localDb, 'cached_catalog', itemId);\n    const cachedSnap = await getDoc(cachedRef);\n    if (cachedSnap.exists()) {\n      const cached = cachedSnap.data();\n      const minutesSinceSync = (new Date() - cached.lastSynced.toDate()) / (1000 * 60);\n      if (minutesSinceSync < 5) {\n        return {\n          success: true,\n          available: cached.status === 'available',\n          status: cached.status,\n          fromCache: true\n        };\n      }\n    }\n    const result = await syncCatalogItem(itemId);\n    if (result.success) {\n      return {\n        success: true,\n        available: result.data.status === 'available',\n        status: result.data.status,\n        fromCache: false\n      };\n    }\n    return result;\n  } catch (error) {\n    console.error('Error checking item availability:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\nexport async function syncEntireCatalog() {\n  try {\n    if (!project2Db) {\n      console.warn('Project 2 not configured yet');\n      return {\n        success: false,\n        error: 'Project 2 catalog not configured yet'\n      };\n    }\n    const catalogSnap = await getDocs(collection(project2Db, 'catalog_items'));\n    const items = [];\n    for (const docSnap of catalogSnap.docs) {\n      const itemData = {\n        ...docSnap.data(),\n        lastSynced: new Date(),\n        source: 'project2'\n      };\n      await setDoc(doc(localDb, 'cached_catalog', docSnap.id), itemData);\n      items.push({\n        id: docSnap.id,\n        ...itemData\n      });\n    }\n    console.log('Entire catalog synced:', items.length, 'items');\n    return {\n      success: true,\n      count: items.length\n    };\n  } catch (error) {\n    console.error('Error syncing entire catalog:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\n\n// ============================================\n// VALIDATION & BUSINESS LOGIC\n// ============================================\n\nexport async function validateHoldRequest(userId, itemId) {\n  try {\n    // Check item availability\n    const availability = await checkItemAvailability(itemId);\n    if (!availability.success) {\n      // If Project 2 not configured, allow hold for testing\n      console.warn('Could not validate availability, allowing for testing');\n    } else if (availability.available) {\n      return {\n        valid: false,\n        reason: 'Item is available - use reservation instead'\n      };\n    }\n\n    // Check if user already has a hold\n    const existingHoldsQuery = query(collection(localDb, 'holds'), where('userId', '==', userId), where('itemId', '==', itemId));\n    const existingHolds = await getDocs(existingHoldsQuery);\n    if (!existingHolds.empty) {\n      return {\n        valid: false,\n        reason: 'You already have a hold on this item'\n      };\n    }\n\n    // Check if user has borrowed this item\n    const userLoans = await syncUserLoans(userId);\n    if (userLoans.success) {\n      const hasBorrowed = userLoans.data.some(loan => loan.itemId === itemId && loan.status === 'BORROWED');\n      if (hasBorrowed) {\n        return {\n          valid: false,\n          reason: 'You currently have this item checked out'\n        };\n      }\n    }\n    return {\n      valid: true\n    };\n  } catch (error) {\n    console.error('Error validating hold request:', error);\n    return {\n      valid: false,\n      reason: error.message\n    };\n  }\n}\nexport async function validateReservationRequest(userId, itemId) {\n  try {\n    // Check item availability\n    const availability = await checkItemAvailability(itemId);\n    if (!availability.success) {\n      console.warn('Could not validate availability, allowing for testing');\n    } else if (!availability.available) {\n      return {\n        valid: false,\n        reason: 'Item is checked out - use hold instead'\n      };\n    }\n\n    // Check if user already has a reservation\n    const existingResQuery = query(collection(localDb, 'reservations'), where('userId', '==', userId), where('itemId', '==', itemId), where('status', '==', 'active'));\n    const existingRes = await getDocs(existingResQuery);\n    if (!existingRes.empty) {\n      return {\n        valid: false,\n        reason: 'You already have a reservation for this item'\n      };\n    }\n    return {\n      valid: true\n    };\n  } catch (error) {\n    console.error('Error validating reservation request:', error);\n    return {\n      valid: false,\n      reason: error.message\n    };\n  }\n}\n\n// ============================================\n// PERIODIC SYNC\n// ============================================\n\nexport async function syncActiveHolds() {\n  try {\n    const holdsSnap = await getDocs(collection(localDb, 'holds'));\n    const uniqueItemIds = [...new Set(holdsSnap.docs.map(d => d.data().itemId))];\n    console.log('Syncing availability for', uniqueItemIds.length, 'items with holds');\n    for (const itemId of uniqueItemIds) {\n      await syncCatalogItem(itemId);\n    }\n    return {\n      success: true,\n      itemCount: uniqueItemIds.length\n    };\n  } catch (error) {\n    console.error('Error syncing active holds:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}","map":{"version":3,"names":["initializeApp","getFirestore","collection","doc","getDoc","getDocs","setDoc","query","where","db","localDb","project4Config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","project2Config","project4App","project4Db","project2Db","syncUserProfile","userId","userRef","userSnap","exists","console","error","success","userData","data","lastSynced","Date","source","log","message","getUserProfile","cachedRef","cachedSnap","cached","hoursSinceSync","toDate","fromCache","syncUserLoans","loansQuery","loansSnap","loans","docs","map","id","length","syncCatalogItem","itemId","warn","itemRef","itemSnap","itemData","checkItemAvailability","minutesSinceSync","available","status","result","syncEntireCatalog","catalogSnap","items","docSnap","push","count","validateHoldRequest","availability","valid","reason","existingHoldsQuery","existingHolds","empty","userLoans","hasBorrowed","some","loan","validateReservationRequest","existingResQuery","existingRes","syncActiveHolds","holdsSnap","uniqueItemIds","Set","d","itemCount"],"sources":["/Users/natnael/Documents/University/CPS 714/CPS714-Library-Hold-and-Reserve-System/src/services/remoteSyncService.js"],"sourcesContent":["// src/services/remoteSyncService.js\n// Syncs data from Project 2 (catalog) and Project 4 (users) into your local Firebase\n\nimport { initializeApp } from 'firebase/app';\nimport { getFirestore, collection, doc, getDoc, getDocs, setDoc, query, where } from 'firebase/firestore';\nimport { db as localDb } from '../firebase-config';\n\n// ============================================\n// REMOTE FIREBASE CONFIGURATIONS\n// ============================================\n\n// Project 4 - User Dashboard Firebase\nconst project4Config = {\n  apiKey: \"AIzaSyA5Q_MVI7W1F58N9cKyDuSmFVsW3QlSTt8\",\n  authDomain: \"cps714-group-3-subproject-4.firebaseapp.com\",\n  databaseURL: \"https://cps714-group-3-subproject-4-default-rtdb.firebaseio.com\",\n  projectId: \"cps714-group-3-subproject-4\",\n  storageBucket: \"cps714-group-3-subproject-4.firebasestorage.app\",\n  messagingSenderId: \"989632490584\",\n  appId: \"1:989632490584:web:4f79336c85fd314d272e2d\"\n};\n\n// Project 2 - Catalog System Firebase\n// TODO: Get this from Project 2 team\nconst project2Config = {\n  apiKey: \"YOUR_PROJECT2_API_KEY\",\n  authDomain: \"your-project2.firebaseapp.com\",\n  projectId: \"your-project2\",\n  storageBucket: \"your-project2.firebasestorage.app\",\n  messagingSenderId: \"YOUR_MESSAGING_ID\",\n  appId: \"YOUR_APP_ID\"\n};\n\n// Initialize remote Firebase apps\nconst project4App = initializeApp(project4Config, 'project4');\nconst project4Db = getFirestore(project4App);\n\n// Uncomment when you get Project 2 credentials\n// const project2App = initializeApp(project2Config, 'project2');\n// const project2Db = getFirestore(project2App);\n\n// Temporary: Use mock data until Project 2 is ready\nconst project2Db = null;\n\n// ============================================\n// USER DATA SYNC (from Project 4)\n// ============================================\n\nexport async function syncUserProfile(userId) {\n  try {\n    const userRef = doc(project4Db, 'users', userId);\n    const userSnap = await getDoc(userRef);\n    \n    if (!userSnap.exists()) {\n      console.error('User not found in Project 4');\n      return { success: false, error: 'User not found' };\n    }\n    \n    const userData = userSnap.data();\n    \n    await setDoc(doc(localDb, 'cached_users', userId), {\n      ...userData,\n      lastSynced: new Date(),\n      source: 'project4'\n    });\n    \n    console.log('User profile synced:', userId);\n    return { success: true, data: userData };\n  } catch (error) {\n    console.error('Error syncing user profile:', error);\n    return { success: false, error: error.message };\n  }\n}\n\nexport async function getUserProfile(userId) {\n  try {\n    const cachedRef = doc(localDb, 'cached_users', userId);\n    const cachedSnap = await getDoc(cachedRef);\n    \n    if (cachedSnap.exists()) {\n      const cached = cachedSnap.data();\n      const hoursSinceSync = (new Date() - cached.lastSynced.toDate()) / (1000 * 60 * 60);\n      \n      if (hoursSinceSync < 1) {\n        return { success: true, data: cached, fromCache: true };\n      }\n    }\n    \n    return await syncUserProfile(userId);\n  } catch (error) {\n    console.error('Error getting user profile:', error);\n    return { success: false, error: error.message };\n  }\n}\n\nexport async function syncUserLoans(userId) {\n  try {\n    const loansQuery = query(\n      collection(project4Db, 'loans'), \n      where('userId', '==', userId)\n    );\n    const loansSnap = await getDocs(loansQuery);\n    \n    const loans = loansSnap.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n    \n    await setDoc(doc(localDb, 'cached_loans', userId), {\n      loans,\n      lastSynced: new Date(),\n      source: 'project4'\n    });\n    \n    console.log('User loans synced:', userId, loans.length);\n    return { success: true, data: loans };\n  } catch (error) {\n    console.error('Error syncing user loans:', error);\n    return { success: false, error: error.message };\n  }\n}\n\n// ============================================\n// CATALOG DATA SYNC (from Project 2)\n// ============================================\n\nexport async function syncCatalogItem(itemId) {\n  try {\n    // TODO: Enable when Project 2 credentials are available\n    if (!project2Db) {\n      console.warn('Project 2 not configured, using mock data');\n      return { success: false, error: 'Project 2 catalog not configured yet' };\n    }\n    \n    const itemRef = doc(project2Db, 'catalog_items', itemId);\n    const itemSnap = await getDoc(itemRef);\n    \n    if (!itemSnap.exists()) {\n      console.error('Item not found in Project 2 catalog');\n      return { success: false, error: 'Item not found' };\n    }\n    \n    const itemData = itemSnap.data();\n    \n    await setDoc(doc(localDb, 'cached_catalog', itemId), {\n      ...itemData,\n      lastSynced: new Date(),\n      source: 'project2'\n    });\n    \n    console.log('Catalog item synced:', itemId);\n    return { success: true, data: itemData };\n  } catch (error) {\n    console.error('Error syncing catalog item:', error);\n    return { success: false, error: error.message };\n  }\n}\n\nexport async function checkItemAvailability(itemId) {\n  try {\n    const cachedRef = doc(localDb, 'cached_catalog', itemId);\n    const cachedSnap = await getDoc(cachedRef);\n    \n    if (cachedSnap.exists()) {\n      const cached = cachedSnap.data();\n      const minutesSinceSync = (new Date() - cached.lastSynced.toDate()) / (1000 * 60);\n      \n      if (minutesSinceSync < 5) {\n        return {\n          success: true,\n          available: cached.status === 'available',\n          status: cached.status,\n          fromCache: true\n        };\n      }\n    }\n    \n    const result = await syncCatalogItem(itemId);\n    if (result.success) {\n      return {\n        success: true,\n        available: result.data.status === 'available',\n        status: result.data.status,\n        fromCache: false\n      };\n    }\n    \n    return result;\n  } catch (error) {\n    console.error('Error checking item availability:', error);\n    return { success: false, error: error.message };\n  }\n}\n\nexport async function syncEntireCatalog() {\n  try {\n    if (!project2Db) {\n      console.warn('Project 2 not configured yet');\n      return { success: false, error: 'Project 2 catalog not configured yet' };\n    }\n    \n    const catalogSnap = await getDocs(collection(project2Db, 'catalog_items'));\n    \n    const items = [];\n    for (const docSnap of catalogSnap.docs) {\n      const itemData = {\n        ...docSnap.data(),\n        lastSynced: new Date(),\n        source: 'project2'\n      };\n      \n      await setDoc(doc(localDb, 'cached_catalog', docSnap.id), itemData);\n      items.push({ id: docSnap.id, ...itemData });\n    }\n    \n    console.log('Entire catalog synced:', items.length, 'items');\n    return { success: true, count: items.length };\n  } catch (error) {\n    console.error('Error syncing entire catalog:', error);\n    return { success: false, error: error.message };\n  }\n}\n\n// ============================================\n// VALIDATION & BUSINESS LOGIC\n// ============================================\n\nexport async function validateHoldRequest(userId, itemId) {\n  try {\n    // Check item availability\n    const availability = await checkItemAvailability(itemId);\n    if (!availability.success) {\n      // If Project 2 not configured, allow hold for testing\n      console.warn('Could not validate availability, allowing for testing');\n    } else if (availability.available) {\n      return { valid: false, reason: 'Item is available - use reservation instead' };\n    }\n    \n    // Check if user already has a hold\n    const existingHoldsQuery = query(\n      collection(localDb, 'holds'),\n      where('userId', '==', userId),\n      where('itemId', '==', itemId)\n    );\n    const existingHolds = await getDocs(existingHoldsQuery);\n    \n    if (!existingHolds.empty) {\n      return { valid: false, reason: 'You already have a hold on this item' };\n    }\n    \n    // Check if user has borrowed this item\n    const userLoans = await syncUserLoans(userId);\n    if (userLoans.success) {\n      const hasBorrowed = userLoans.data.some(\n        loan => loan.itemId === itemId && loan.status === 'BORROWED'\n      );\n      if (hasBorrowed) {\n        return { valid: false, reason: 'You currently have this item checked out' };\n      }\n    }\n    \n    return { valid: true };\n  } catch (error) {\n    console.error('Error validating hold request:', error);\n    return { valid: false, reason: error.message };\n  }\n}\n\nexport async function validateReservationRequest(userId, itemId) {\n  try {\n    // Check item availability\n    const availability = await checkItemAvailability(itemId);\n    if (!availability.success) {\n      console.warn('Could not validate availability, allowing for testing');\n    } else if (!availability.available) {\n      return { valid: false, reason: 'Item is checked out - use hold instead' };\n    }\n    \n    // Check if user already has a reservation\n    const existingResQuery = query(\n      collection(localDb, 'reservations'),\n      where('userId', '==', userId),\n      where('itemId', '==', itemId),\n      where('status', '==', 'active')\n    );\n    const existingRes = await getDocs(existingResQuery);\n    \n    if (!existingRes.empty) {\n      return { valid: false, reason: 'You already have a reservation for this item' };\n    }\n    \n    return { valid: true };\n  } catch (error) {\n    console.error('Error validating reservation request:', error);\n    return { valid: false, reason: error.message };\n  }\n}\n\n// ============================================\n// PERIODIC SYNC\n// ============================================\n\nexport async function syncActiveHolds() {\n  try {\n    const holdsSnap = await getDocs(collection(localDb, 'holds'));\n    const uniqueItemIds = [...new Set(holdsSnap.docs.map(d => d.data().itemId))];\n    \n    console.log('Syncing availability for', uniqueItemIds.length, 'items with holds');\n    \n    for (const itemId of uniqueItemIds) {\n      await syncCatalogItem(itemId);\n    }\n    \n    return { success: true, itemCount: uniqueItemIds.length };\n  } catch (error) {\n    console.error('Error syncing active holds:', error);\n    return { success: false, error: error.message };\n  }\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}